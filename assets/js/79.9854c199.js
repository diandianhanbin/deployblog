(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{423:function(n,s,a){"use strict";a.r(s);var t=a(0),e=Object(t.a)({},(function(){var n=this,s=n.$createElement,a=n._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("p",[a("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537776691.705579.jpg",alt:"20161109"}})]),n._v(" "),a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[n._v("#")]),n._v(" 背景")]),n._v(" "),a("p",[n._v("Docker是时下很流行的东西，具体的介绍就不多说了，简单说说我今天用Docker构建Python的过程")]),n._v(" "),a("h2",{attrs:{id:"环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境"}},[n._v("#")]),n._v(" 环境")]),n._v(" "),a("hr"),n._v(" "),a("p",[n._v("操作系统： macOS Sierra")]),n._v(" "),a("p",[n._v("Python： 2.7")]),n._v(" "),a("p",[n._v("Docker: 1.12.3")]),n._v(" "),a("p",[n._v("Client:\nVersion:      1.12.3\nAPI version:  1.24\nGo version:   go1.6.3\nGit commit:   6b644ec\nBuilt:        Wed Oct 26 23:26:11 2016\nOS/Arch:      darwin/amd64")]),n._v(" "),a("p",[n._v("Server:\nVersion:      1.12.3\nAPI version:  1.24\nGo version:   go1.6.3\nGit commit:   6b644ec\nBuilt:        Wed Oct 26 23:26:11 2016\nOS/Arch:      linux/amd64")]),n._v(" "),a("hr"),n._v(" "),a("h2",{attrs:{id:"编写dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写dockerfile"}},[n._v("#")]),n._v(" 编写Dockerfile")]),n._v(" "),a("p",[n._v("首先我们需要编写一个Dockerfile，用来构建Docker环境以及Python的依赖。")]),n._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[n._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" ~/Desktop\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("mkdir")]),n._v(" dockerpython\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" dockerpython\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("touch")]),n._v(" Dockerfile\n\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br")])]),a("p",[a("strong",[n._v("注意：这里的Dockerfile没有扩展名。")])]),n._v(" "),a("p",[n._v("然后用Vim或者Sublime打开这个文件，输入以下内容")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('FROM ubuntu\n\nMAINTAINER Sven Weng <sven@wengyb.com>\n\n# APT 自动安装 Python 相关的依赖包，如需其他依赖包在此添加\nRUN apt-get update && \\  \n      apt-get install -y python \\\n                       python-dev \\\n                       python-pip  \\\n    # 用完包管理器后安排打扫卫生可以显著的减少镜像大小\n    && apt-get clean \\\n    && apt-get autoclean \\\n    && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \n\n# 配置默认放置 App 的目录\nRUN mkdir -p /app  \nWORKDIR /app  \nEXPOSE 80  \nCMD ["bash"] \n')])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br"),a("span",{staticClass:"line-number"},[n._v("9")]),a("br"),a("span",{staticClass:"line-number"},[n._v("10")]),a("br"),a("span",{staticClass:"line-number"},[n._v("11")]),a("br"),a("span",{staticClass:"line-number"},[n._v("12")]),a("br"),a("span",{staticClass:"line-number"},[n._v("13")]),a("br"),a("span",{staticClass:"line-number"},[n._v("14")]),a("br"),a("span",{staticClass:"line-number"},[n._v("15")]),a("br"),a("span",{staticClass:"line-number"},[n._v("16")]),a("br"),a("span",{staticClass:"line-number"},[n._v("17")]),a("br"),a("span",{staticClass:"line-number"},[n._v("18")]),a("br"),a("span",{staticClass:"line-number"},[n._v("19")]),a("br")])]),a("p",[n._v("然后执行"),a("code",[n._v("docker build -t .")])]),n._v(" "),a("p",[n._v("看着命令行一直跳吧，跳到结束基于Docker的Python环境就搭建好了")]),n._v(" "),a("h2",{attrs:{id:"dockerfile几个命令的解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile几个命令的解释"}},[n._v("#")]),n._v(" Dockerfile几个命令的解释")]),n._v(" "),a("p",[n._v("我们的Python环境实质上是建立一个带有Python的Ubuntu系统。")]),n._v(" "),a("p",[a("code",[n._v("FROM")]),n._v("表示一个依赖的镜像，这里我们的python环境需要ubuntu。")]),n._v(" "),a("p",[a("code",[n._v("MAINTAINER")]),n._v("表示一个署名，可以随意写。")]),n._v(" "),a("p",[a("code",[n._v("RUN")]),n._v("表示拉取Ubuntu系统后，要执行哪些命令，这里我们要执行"),a("code",[n._v("apt-get")]),n._v("的更新，安装Python的依赖")]),n._v(" "),a("p",[a("code",[n._v("WORKDIR")]),n._v("表示工作目录")]),n._v(" "),a("p",[a("code",[n._v("EXPOSE")]),n._v("表示对外暴露的端口")]),n._v(" "),a("p",[a("code",[n._v("CMD")]),n._v("构建完成后执行的命令")]),n._v(" "),a("h2",{attrs:{id:"运行容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行容器"}},[n._v("#")]),n._v(" 运行容器")]),n._v(" "),a("p",[a("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537776721.1749382.jpg",alt:""}})]),n._v(" "),a("p",[n._v("以上就是我们创建好的镜像,看到了两个none,于是我们再执行"),a("code",[n._v("docker tag 8a7 withpython/ubuntu")]),n._v("命令来重新打标签。")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("SvenWeng@wengyanbin:~/Desktop|⇒  docker tag 8a7 withpython/ubuntu\nSvenWeng@wengyanbin:~/Desktop|⇒  docker images\nREPOSITORY                 TAG                 IMAGE ID            CREATED             SIZE\nwithpython/ubuntu          latest              8a73e75b23ba        29 minutes ago      127.2 MB\nubuntu                     latest              f753707788c5        4 weeks ago         127.2 MB\ndaocloud.io/sakeven/2048   latest              ccb67859d5ac        12 weeks ago        7.476 MB\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br")])]),a("p",[a("code",[n._v("docker tag")]),n._v("命令的使用方式如下：")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("SvenWeng@wengyanbin:~/Desktop|⇒  docker tag --help\n\nUsage:\tdocker tag IMAGE[:TAG] IMAGE[:TAG]\n\nTag an image into a repository\n\nOptions:\n      --help   Print usage\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br"),a("span",{staticClass:"line-number"},[n._v("2")]),a("br"),a("span",{staticClass:"line-number"},[n._v("3")]),a("br"),a("span",{staticClass:"line-number"},[n._v("4")]),a("br"),a("span",{staticClass:"line-number"},[n._v("5")]),a("br"),a("span",{staticClass:"line-number"},[n._v("6")]),a("br"),a("span",{staticClass:"line-number"},[n._v("7")]),a("br"),a("span",{staticClass:"line-number"},[n._v("8")]),a("br")])]),a("p",[n._v("现在我们来启动容器.")]),n._v(" "),a("p",[a("code",[n._v("docker run -i -t 8a7")])]),n._v(" "),a("p",[n._v("我们就进入了这个Ubuntu的bash，执行"),a("code",[n._v("python")]),n._v("就可以看到进入python的交互模式了。")]),n._v(" "),a("h2",{attrs:{id:"一个问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一个问题"}},[n._v("#")]),n._v(" 一个问题")]),n._v(" "),a("p",[n._v("在我重新执行的时候发现了一个问题，最初我是使用Daocloud的镜像"),a("code",[n._v("FROM daocloud.io/ubuntu:trusty")]),n._v("来处理的，可以直接安装成功，但是我第二次编写的时候用了官方的镜像，它给我报错了。")]),n._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("The command '/bin/sh -c apt-get update &&       apt-get install -y python                        python-dev                        python-pip      && pip install requests     && apt-get install wget     && apt-get clean     && apt-get autoclean     && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*' returned a non-zero code: 1\n")])]),n._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[n._v("1")]),a("br")])]),a("p",[n._v("也许是Daocloud为了写这个教程，对官方的Ubuntu做了一些修改，所以能一次性成功，如果你也遇到了这个问题，可以使用Daocloud的这个镜像。当然，你也可以手工执行这些命令，这就是在Ubuntu上搭建Python的步骤，没有什么难度。")])])}),[],!1,null,null,null);s.default=e.exports}}]);