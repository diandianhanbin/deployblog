(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{381:function(s,a,e){"use strict";e.r(a);var t=e(0),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("原文地址："),e("a",{attrs:{href:"https://developer.apple.com/library/prerelease/content/documentation/DeveloperTools/Conceptual/testing_with_xcode/chapters/02-quick_start.html#//apple_ref/doc/uid/TP40014132-CH2-SW1",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://developer.apple.com/library/prerelease/content/documentation/DeveloperTools/Conceptual/testing_with_xcode/chapters/02-quick_start.html#//apple_ref/doc/uid/TP40014132-CH2-SW1"),e("OutboundLink")],1)]),s._v(" "),e("h2",{attrs:{id:"文章导读"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文章导读"}},[s._v("#")]),s._v(" 文章导读")]),s._v(" "),e("p",[s._v("本篇介绍了Xcode执行测试的方法，说明了Xcode工具如何新建、执行一个测试用例。")]),s._v(" "),e("p",[s._v("看完之后你能学习到：")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("如何使用Xcode来创建一个测试用例。")])]),s._v(" "),e("li",[e("p",[s._v("如何执行测试用例")])]),s._v(" "),e("li",[e("p",[s._v("如何观察Xcode的测试结果")])])]),s._v(" "),e("h2",{attrs:{id:"声明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#声明"}},[s._v("#")]),s._v(" 声明")]),s._v(" "),e("p",[s._v("文章翻译自Apple官方文档《Testing with Xcode》，不保证每个字都能翻译的精准，如有翻译错误，请留言指出，不胜感激。")]),s._v(" "),e("h1",{attrs:{id:"quickstart"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quickstart"}},[s._v("#")]),s._v(" QuickStart")]),s._v(" "),e("p",[s._v("这个快速入门是为了告诉你，你可以很容易的给你开发的软件做一些必须的测试。")]),s._v(" "),e("h2",{attrs:{id:"介绍测试导航菜单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#介绍测试导航菜单"}},[s._v("#")]),s._v(" 介绍测试导航菜单")]),s._v(" "),e("p",[s._v("当你开始测试工作的时候，你经常会使用Xcode的导航器。")]),s._v(" "),e("p",[s._v("测试导航菜单是工作区的一部分，是让你便捷的创建，管理，运行和检视测试代码。你可以点击在issue导航和debug导航中间的的图标进入测试导航菜单。当你有一个项目，其中的测试内容已确定，如下图你可以在这里看到类似的导航菜单。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537975844451945.jpg",alt:"twx-qs-1_2x"}})]),s._v(" "),e("p",[s._v("上图中的测试导航菜单举例展示了以列表的形式分级测试包，类型，以及方法。这个项目是一个类似计算器的app。计算器的核心是以一个框架来执行代码，可以看到优先级最高的"),e("code",[s._v("SampleCalcTests")]),s._v("测试包，是为了测试应用的代码。")]),s._v(" "),e("hr"),s._v(" "),e("p",[s._v("**注意：**Xcode的测试目标会生成测试包，并展示在测试导航菜单中。")]),s._v(" "),e("p",[s._v("如果你测试时使用数据，图片和其他内容，他们可以被添加到测试包，在执行的时候使用"),e("code",[s._v("NSBundle")]),s._v("APIs实现存取。使用"),e("code",[s._v("+[NSBundle bundleForClass:]")]),s._v("和你的测试类时，区分类型，以确保得到正确的测试包来检索数据。更多详情请看"),e("a",{attrs:{href:"https://developer.apple.com/reference/foundation/nsbundle",target:"_blank",rel:"noopener noreferrer"}},[s._v("NSBundle Class Reference"),e("OutboundLink")],1),s._v(".")]),s._v(" "),e("p",[s._v("Xcode执行计划会所控制构建的内容。执行计划也会控制可用的测试方法来执行测试操作。你可以在测试菜单中使用Control-clicking以及通过快捷菜单来有选择的使用或者忽略测试包，类和方法。")]),s._v(" "),e("hr"),s._v(" "),e("p",[s._v("在视图中被激活的测试包是"),e("code",[s._v("SampleCalcTests. SampleCalcTests")]),s._v("，它包含了一个测试包，轮换着控制（使用）九种测试方法。当你把鼠标放在列表中任意一项上，这是一个快速的方式来运行一个测试包中所有的测试项、一个类中所有的测试项、或者任意一个单独的测试。测试结束后会返回成功或失败的结果给Xcode。当测试被执行时，这些图标会更新，给你展示测试的结果。绿色对勾表示通过，红色叉叉表示失败。这里测试导航菜单显示的测试结果，有两项被断言为失败。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537975866692873.jpg",alt:"twx-qs-2_2x"}})]),s._v(" "),e("p",[s._v("点击列表中任意一个测试类或者测试方法，会在代码编辑器中打开对应的测试类。测试类和测试方法也会在编辑器中做上标记。工作原理和在测试导航菜单上一样。测试失败会在代码编辑器中展示有关联断言的结果字符串。")]),s._v(" "),e("p",[s._v("在测试菜单的底部是增加按钮和过滤控制，你可以减少展示的内容，只显示活动的测试项或者只展示失败的测试，当然，你也可以按照名称来过滤。")]),s._v(" "),e("p",[s._v("更多测试导航菜单的详细信息，请看"),e("em",[s._v("Test Navigator Help")]),s._v("。")]),s._v(" "),e("h2",{attrs:{id:"为你的app增加测试方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为你的app增加测试方法"}},[s._v("#")]),s._v(" 为你的APP增加测试方法")]),s._v(" "),e("p",[s._v("在Xcode5和以后的版本中你在新建app，框架和资源的时候会预设一个测试的目标。当你开始一个新的项目时打开测试导航菜单，你可以看到一个测试包，一个测试类和一个测试方法的模板。但是你可能会从一个Xcode早期版本中打开一个预先存在的项目，此项目没有确定的测试目标。这里的工作流程假设一个之前的项目是没有纳入测试的。")]),s._v(" "),e("h3",{attrs:{id:"创建一个测试目标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建一个测试目标"}},[s._v("#")]),s._v(" 创建一个测试目标")]),s._v(" "),e("p",[s._v("点击测试导航菜单左下方的增加按钮来选择新建一个"),e("code",[s._v("Unit Test Target")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/15379758897142.jpg",alt:"twx-qs-3_2x"}})]),s._v(" "),e("p",[s._v("在下一个对话框中选择OS X或者IOS"),e("code",[s._v("Unit Testing Bundle")]),s._v("，然后点击"),e("code",[s._v("Next")]),s._v("。会出现一个新的对话框，编辑项目名称和其他你需要的参数。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/15379759086501.jpg",alt:"twx-qs-4_2x"}})]),s._v(" "),e("p",[s._v("点击"),e("code",[s._v("Finish")]),s._v("来增加你的target，在测试导航菜单师徒中包含了一个测试类的模板和两个测试方法的模板")]),s._v(" "),e("h3",{attrs:{id:"运行测试和观察结果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行测试和观察结果"}},[s._v("#")]),s._v(" 运行测试和观察结果")]),s._v(" "),e("p",[s._v("现在你已经为你的项目增加测试方法了。你想要开发一些有用的测试方法。但是首先，先把鼠标放到测试导航菜单的"),e("code",[s._v("SampleCalcTests")]),s._v("上并点击运行按钮来执行所有的测试方法。测试结果会在函数名的旁边用绿色的标记标记出来，在代码编辑器中也一样。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537975927083082.jpg",alt:"twx-qs-6_2x"}})]),s._v(" "),e("p",[s._v("模板中的单元测试和演示的测试方法都是空的。这就是为什么他们都会被标记为成功，没有失败的断言。注意34行灰色菱形"),e("code",[s._v("measureBlock:")]),s._v("方法。点击菱形来展示演示结果的面板。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537975947987968.jpg",alt:"twx-qs-7_2x"}})]),s._v(" "),e("p",[s._v("面板允许你设置一个预期的基线、编辑基线和最大STDDEV参数。这些特点稍后会讨论。")]),s._v(" "),e("h3",{attrs:{id:"编辑测试案例再次运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编辑测试案例再次运行"}},[s._v("#")]),s._v(" 编辑测试案例再次运行")]),s._v(" "),e("p",[s._v("由于这个样本项目是一个计算器APP，你想要检查它能否正确的执行加减乘除和其他计算功能。由于测试是在app项目内部构建，你可以增加所有你愿意增加的测试情景在程序的任意层。创建测试要做的事就是给整个单元添加函数来测试实现文件。")]),s._v(" "),e("p",[s._v("例如。你插入如下"),e("code",[s._v("#import")]),s._v("和给"),e("code",[s._v("SampleCalcTests.m")]),s._v("增加变量")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('#import <XCTest/XCTest.h>\n\n//\n\n// Import the application specific header files\n\n#import "CalcViewController.h"\n\n#import "CalcAppDelegate.h"\n\n \n\n@interface CalcTests : XCTestCase {\n\n// add instance variables to the CalcTests class\n\n@private\n\n    NSApplication       *app;\n\n    CalcAppDelegate     *appDelegate;\n\n    CalcViewController  *calcViewController;\n\n    NSView              *calcView;\n\n}\n\n@end\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br")])]),e("p",[s._v("然后给测试方法一个描述的名称，就像"),e("code",[s._v("testAddition")]),s._v("一样，然后为方法增加一个执行的代码。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('- (void) testAddition\n\n{\n\n   // obtain the app variables for test access\n\n   app                  = [NSApplication sharedApplication];\n\n   calcViewController   = (CalcViewController*)[[NSApplication sharedApplication] delegate];\n\n   calcView             = calcViewController.view;\n\n \n\n   // perform two addition tests\n\n   [calcViewController press:[calcView viewWithTag: 6]];  // 6\n\n   [calcViewController press:[calcView viewWithTag:13]];  // +\n\n   [calcViewController press:[calcView viewWithTag: 2]];  // 2\n\n   [calcViewController press:[calcView viewWithTag:12]];  // =\n\n    XCTAssertEqualObjects([calcViewController.displayField stringValue], @"8", @"Part 1 failed.");\n\n \n\n   [calcViewController press:[calcView viewWithTag:13]];  // +\n\n   [calcViewController press:[calcView viewWithTag: 2]];  // 2\n\n   [calcViewController press:[calcView viewWithTag:12]];  // =\n\n    XCTAssertEqualObjects([calcViewController.displayField stringValue], @"10", @"Part 2 failed.");\n\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br")])]),e("p",[s._v("注意测试导航菜单中样例的测试方法，"),e("code",[s._v("testExample")]),s._v("被替换成了"),e("code",[s._v("testAddition")]),s._v("。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537975965611209.jpg",alt:"twx-qs-8_2x"}})]),s._v(" "),e("p",[s._v("现在点击测试导航菜单中的运行按钮（或者代码编辑器中的指示）来运行"),e("code",[s._v("testAddition")]),s._v("方法。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/153797598856436.jpg",alt:"twx-qs-9_2x"}})]),s._v(" "),e("p",[s._v("就像你看到的一样，一个断言失败了，在测试导航菜单和代码编辑器中都高亮显示了。看源代码。Part 1成功了，是Part 2有一个问题。在相近的测试中，错误很明显：在76行，"),e("code",[s._v("[calcView viewWithTag:11]")]),s._v("错了。应该是"),e("code",[s._v("[calcView viewWithTag:12]")]),s._v("。收集错误信息修复问题后，测试成功。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/1537976062331423.jpg",alt:"twx-qs-8a_2x"}})]),s._v(" "),e("h3",{attrs:{id:"为普通的代码使用setup-和teardown-方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为普通的代码使用setup-和teardown-方法"}},[s._v("#")]),s._v(" 为普通的代码使用setUp()和tearDown()方法")]),s._v(" "),e("p",[s._v("Xcode为活动的测试包运行所有的测试方法一次。在这个小例子中只有一个方法执行了。它需要获得三个计算器app提供的变量对象来运行。如果你写了四个或者五个测试方法在同样的类中。你会发现你需要为每一条测试案例输入重复的代码来获得app的运算结果。XCTest框架提供给你来运行测试类，"),e("code",[s._v("setUp")]),s._v("和"),e("code",[s._v("tearDown")]),s._v("的实例方法，你可以用他们来放置每次执行测试方法的前置方法和结束方法。")]),s._v(" "),e("p",[s._v("使用"),e("code",[s._v("setUp")]),s._v("和"),e("code",[s._v("tearDown")]),s._v("方法很简单。从"),e("code",[s._v("Mac_Calc_Tests.m")]),s._v("文件中的"),e("code",[s._v("testAddition")]),s._v("代码中剪切4行"),e("code",[s._v("// obtain the app variable for test access")]),s._v("然后粘贴他们到模板默认的"),e("code",[s._v("setUp")]),s._v("实例方法中。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("- (void)setUp\n\n{\n\n    [super setUp];\n\n    // Put setup code here. This method is called before the invocation of each test method in the class.\n\n \n\n   // obtain the app variables for test access\n\n   app                  = [NSApplication sharedApplication];\n\n   calcViewController   = (CalcViewController*)[[NSApplication sharedApplication] delegate];\n\n   calcView             = calcViewController.view;\n\n}\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("p",[s._v("现在增加更多只使用最少代码的测试方法——"),e("code",[s._v("testSubtraction")]),s._v("和其他方法。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://blog-img-1251534856.cos.ap-guangzhou.myqcloud.com/153797610154141.jpg",alt:"twx-qs-10_2x"}})]),s._v(" "),e("h2",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),e("p",[s._v("从这个简短的快速入门你可以看到，它给项目增加测试是非常简单的。这里有一些需要注意的地方：")]),s._v(" "),e("ul",[e("li",[s._v("Xcode能建立绝大多数基础的测试框架。当你为你的项目增加一个测试target时，Xcode会自动把它添加到关联的产品目标上去。一个最初的测试类只带一个被添加目标的测试方法，能在测试导航菜单中被找到。")]),s._v(" "),e("li",[s._v("测试导航菜单让你很容易的定位和编辑测试方法。你可以在测试导航菜单中使用导航按钮直接运行测试方法，或者在打开的测试类中直接从代码编辑器中运行。当一个测试失败时，测试导航菜单和代码编辑器都会把失败的部分标记出来")]),s._v(" "),e("li",[s._v("一个单独的测试方法可以包含该多个断言，结果只显示一个通过或者失败。这种方式允许你根据项目需要创建简单或者复杂的测试。")]),s._v(" "),e("li",[e("code",[s._v("setUp")]),s._v("方法和"),e("code",[s._v("tearDown")]),s._v("方法作为入口方法，能够让你把常用的代码统一的使用在方法中，保持代码的连贯性也更容易发现问题。")])]),s._v(" "),e("h2",{attrs:{id:"感谢"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#感谢"}},[s._v("#")]),s._v(" 感谢")]),s._v(" "),e("p",[e("strong",[s._v("感谢小强在百忙之中抽空帮忙校验。")])])])}),[],!1,null,null,null);a.default=n.exports}}]);